@startuml analysis

class Connect4 {
    
    + Connect4()
    + playGames()
    - isResumed()
}
Connect4 *--> Game
Connect4 *--> GameView
Connect4 ..> Message
Connect4 ..> YesNoDialog



class YesNoDialog #Pink {
    - {static} AFFIRMATIVE
    - {static} NEGATIVE
    - {static} SUFIX
    - {static} ERROR
    - answer

    + YesNoDialog()
    + read(question)
    + isAffirmative()
    - isNegative()
    - getAnswer()
}

class GameView #LightYellow {

    + GameView(game)
    + play()
}
GameView --> Game
GameView *--> BoardView
GameView *--> TurnView
GameView ..> Message

class BoardView #LightYellow {
    - {static} COLUMN_LENGTH    

    + BoardView(board)
    + write()
    - {static} writeHorizontal()
}
BoardView --> Board
BoardView *--> ColorView
BoardView ..> Coordinate
BoardView ..> Message

class ColorView #LightYellow {
    - COLOR_LENGTH

    + ColorView(colorLength)
    + write(color)
    - isMiddle(index)
}
ColorView ..> Color

class TurnView #LightYellow {

    + TurnView(turn)
    - getPlayerView()
    + play()
    + readGameMode()
    + writeResult()    
}
TurnView --> Turn
TurnView --> "NUMBER_PLAYERS" PlayerView
TurnView ..> Message
TurnView ..> SettingView

class SettingView #LightYellow {

    + SettingView(turn)
    + readGameMode()
    - getNumUsers()
}
SettingView --> Turn
SettingView ..> Message
SettingView ..> ClosedInterval
SettingView ..> UserView
SettingView ..> RandomView

abstract class PlayerView #LightYellow {

    + PlayerView(player)    
    + dropToken()
    + {abstract} readColumn()
    + isComplete(column)
    + writeWin()
}
PlayerView --> Player
PlayerView ..> Message

class UserView #LightYellow {

    + UserView(player)
    + readColumn()
}
PlayerView <|-- UserView
UserView ..> Coordinate

class RandomView #LightYellow {

    + UserView(player)
    + readColumn()
}
PlayerView <|-- RandomView
RandomView ..> Coordinate

enum Message #LightYellow {
    MANY MESSAGES
    - string

    + write()
    + writeln()
    + toString()
}
Message ..> Turn
Message ..> Color

class Game #LightCyan {

    + Game()
    + isFinished()
    + changeTurn()
    + reset()
    + getBoard()
    + getTurn()
}
Game *--> Board
Game *--> Turn

class Turn #LightCyan {
    + {static} NUMBER_PLAYERS
    - activePlayer

    + Turn(board)
    + reset()
    + isWinner()
    + change()   
    + getPlayer(ordinal)
    + getIndex()
}
Turn *--> "NUMBER_PLAYERS" Player
Turn ..> Color

class Player #LightCyan {

    + Player(color, board)
    + dropToken(column)
    + isComplete(column)
    + isWinner()
    + toString()
}
Player --> Color
Player --> Board

class Board #LightCyan {

    + Board()
    + reset()
    + dropToken(column, color)
    + isComplete(column)
    - isEmpty(coordinate)
    + getColor(coordinate)
    + isWinner(color)
    - isConnect4(line)
}
Board *--> Coordinate : lastDrop
Board *--> "NUMBER_ROWS * NUMBER_COLUMNS" Color
Board ..> Vector
Board ..> Line

class Line #LightCyan {
    + {static} WIN_LENGTH

    + Line(origin, vector)
    + shiftedToOpposite()
    + getCoordinates()
    + isValid()
}
Line --> Coordinate : origin
Line --> Vector

class Vector #LightCyan {
    + {static} NORTH
    + {static} EAST
    + {static} NORTH_EAST
    + {static} SOUTH_EAST

    + Vector(row, column)
    + opposited()
    + toCoordinate()
}
Vector *--> Coordinate

class Coordinate #LightCyan {
    + {static} NUMBER_ROWS
    + {static} NUMBER_COLUMNS
    - row
    - column

    + Coordinate(row, column)
    + {static} getRandomColumn()
    - {static} isRowValid(row)
    + {static} isColumnValid(column)
    + isValid()
    + shifted(coordinate)
    + opposited()
    + getRow()
    + getColumn()
}
Coordinate ..> ClosedInterval

enum Color #LightCyan {
    RED
    YELLOW
    NULL
    - string

    + {static} get(ordinal)
    - {static} values()
    + isNull()
    + toString()
}
Color ..> ClosedInterval

class ClosedInterval #LightSteelBlue {
    - min
    - max

    + ClosedInterval(min, max)
    + isIncluded(value)
}

@enduml
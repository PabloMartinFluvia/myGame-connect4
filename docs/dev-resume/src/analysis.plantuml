@startuml analysis

'' app

class Connect4 {
    
    + constructor()
    + playGames()
}
Connect4 *--> Board
Connect4 *--> Turn
Connect4 *--> BoardView
Connect4 *--> TurnView
Connect4 ..> ResumeView
Connect4 ..> Message

'' views

class YesNoDialog #LightYellow {
    - {static} AFFIRMATIVE
    - {static} NEGATIVE
    - answer

    + constructor()
    + read(question)
    + isAffirmative()
    - isNegative()
    - getAnswer()
}
YesNoDialog ..> ConsoleMPDS
YesNoDialog ..> assert

class TurnView #LightYellow {

    + constructor(turn)    
    + play()
    + readGameMode()
    + writeResult()    
}
TurnView --> Turn
TurnView ..> PlayerView
TurnView ..> Error
TurnView ..> ErrorView
TurnView ..> Message
TurnView ..> ConsoleMPDS
TurnView ..> assert

class PlayerView #LightYellow {

    + constructor(player)    
    + play()
    + visitUserPlayer(userPlayer)
    + visitRandomPlayer(randomPlayer)
    + writeWin()
}
PlayerVisitor <|.up. PlayerView
PlayerView --> Player
PlayerView ..> Error
PlayerView ..> ErrorView
PlayerView ..> Message
PlayerView ..> ConsoleMPDS
PlayerView ..> assert

class ErrorView #LightYellow {
    - {static} MESSAGES

    + constructor(error)
    + writeln()
}
ErrorView --> Error
ErrorView ..> Message
ErrorView ..> ClosedInterval
ErrorView ..> assert

class ResumeView #LightYellow {

    + constructor(board, turn)
    + read()
    + isResume()
}
ResumeView *--> YesNoDialog
ResumeView --> Board
ResumeView --> Turn
ResumeView ..> Message
ResumeView ..> assert

enum Message #LightYellow {
    + MESSAGES
    - msg

    - constructor(msg)
    + write()
    + writeln()
    + toString()
}
Message ..> Turn
Message ..> Coordinate
Message ..> ConsoleMPDS

class ConsoleMPDS #LightYellow 

class BoardView #LightYellow {
    - {static} CHARS_PER_CELL    

    + constructor(board)
    - {static} writeHorizontal()
    + write()    
    - writeCell()
    - {static} isMiddleCell(index)
}
BoardView --> Board
BoardView ..> Coordinate
BoardView ..> Color
BoardView ..> Message
BoardView ..> ConsoleMPDS
BoardView ..> assert


'' utils

class ClosedInterval #LightSteelBlue {
    - min
    - max

    + constructor(min, max)
    + isIncluded(value)
}
ClosedInterval ..> assert

class assert #LightSteelBlue

'' models

abstract class Player #LightCyan {

    + constructor(color, board)
    + {abstract} accept(visitor)
    + dropToken(column)    
    # isComplete(column)    
    + getName()    
}
Player --> Color
Player --> Board
Player ..> PlayerVisitor
Player ..> assert

class UserPlayer #LightCyan {

    + constructor(color, board)
    + accept(visitor)
    + getErrorColumn(column)
}
Player <|-- UserPlayer
UserPlayer ..> Coordinate
UserPlayer ..> Error

class RandomPlayer #LightCyan {

    + constructor(color, board)
    + accept(visitor)
    + getRandomColumn()
}
Player <|-- RandomPlayer
RandomPlayer ..> Coordinate

interface PlayerVisitor #LightCyan {

    + visitUserPlayer(userPlayer)
    + visitRandomPlayer(randomPlayer)
}
PlayerVisitor ..> UserPlayer
PlayerVisitor ..> RandomPlayer

class Turn #LightCyan {
    + {static} NUMBER_PLAYERS
    - activePlayer

    + Turn(board)
    + reset()
    + isWinner()
    + change()   
    + getPlayer(ordinal)
    + getIndex()
}
Turn *--> "NUMBER_PLAYERS" Player
Turn --> Board
Turn ..> UserPlayer : <new>
Turn ..> RandomPlayer : <new>
Turn ..> Color
Turn ..> Error
Turn ..> ClosedInterval
Turn ..> assert












class Board #LightCyan {

    + Board()
    + reset()
    + dropToken(column, color)
    + isComplete(column)
    - isEmpty(coordinate)
    + getColor(coordinate)
    + isWinner(color)
    - isConnect4(line)
}
Board *--> Coordinate : lastDrop
Board *--> "NUMBER_ROWS * NUMBER_COLUMNS" Color
Board ..> Vector
Board ..> Line

class Line #LightCyan {
    + {static} WIN_LENGTH

    + Line(origin, vector)
    + shiftedToOpposite()
    + getCoordinates()
    + isValid()
}
Line --> Coordinate : origin
Line --> Vector

class Vector #LightCyan {
    + {static} NORTH
    + {static} EAST
    + {static} NORTH_EAST
    + {static} SOUTH_EAST

    + Vector(row, column)
    + opposited()
    + toCoordinate()
}
Vector *--> Coordinate

class Coordinate #LightCyan {
    + {static} NUMBER_ROWS
    + {static} NUMBER_COLUMNS
    - row
    - column

    + Coordinate(row, column)
    + {static} getRandomColumn()
    - {static} isRowValid(row)
    + {static} isColumnValid(column)
    + isValid()
    + shifted(coordinate)
    + opposited()
    + getRow()
    + getColumn()
}
Coordinate ..> ClosedInterval

enum Color #LightCyan {
    RED
    YELLOW
    NULL
    - string

    + {static} get(ordinal)
    - {static} values()
    + isNull()
    + toString()
}
Color ..> ClosedInterval



@enduml